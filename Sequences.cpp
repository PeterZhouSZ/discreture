#include "Sequences.hpp"
#include <cassert>
namespace dscr 
{	
	vector<vector<lluint>> Sequence::binomial = 
{{ 1 },
{ 1 },
{ 1,  2 },
{ 1,  3 },
{ 1,  4,  6 },
{ 1,  5,  10 },
{ 1,  6,  15,  20 },
{ 1,  7,  21,  35 },
{ 1,  8,  28,  56,  70 },
{ 1,  9,  36,  84,  126 },
{ 1,  10,  45,  120,  210,  252 },
{ 1,  11,  55,  165,  330,  462 },
{ 1,  12,  66,  220,  495,  792,  924 },
{ 1,  13,  78,  286,  715,  1287,  1716 },
{ 1,  14,  91,  364,  1001,  2002,  3003,  3432 },
{ 1,  15,  105,  455,  1365,  3003,  5005,  6435 },
{ 1,  16,  120,  560,  1820,  4368,  8008,  11440,  12870 },
{ 1,  17,  136,  680,  2380,  6188,  12376,  19448,  24310 },
{ 1,  18,  153,  816,  3060,  8568,  18564,  31824,  43758,  48620 },
{ 1,  19,  171,  969,  3876,  11628,  27132,  50388,  75582,  92378 },
{ 1,  20,  190,  1140,  4845,  15504,  38760,  77520,  125970,  167960,  184756 },
{ 1,  21,  210,  1330,  5985,  20349,  54264,  116280,  203490,  293930,  352716 },
{ 1,  22,  231,  1540,  7315,  26334,  74613,  170544,  319770,  497420,  646646,  705432 },
{ 1,  23,  253,  1771,  8855,  33649,  100947,  245157,  490314,  817190,  1144066,  1352078 },
{ 1,  24,  276,  2024,  10626,  42504,  134596,  346104,  735471,  1307504,  1961256,  2496144,  2704156 },
{ 1,  25,  300,  2300,  12650,  53130,  177100,  480700,  1081575,  2042975,  3268760,  4457400,  5200300 },
{ 1,  26,  325,  2600,  14950,  65780,  230230,  657800,  1562275,  3124550,  5311735,  7726160,  9657700,  10400600 },
{ 1,  27,  351,  2925,  17550,  80730,  296010,  888030,  2220075,  4686825,  8436285,  13037895,  17383860,  20058300 },
{ 1,  28,  378,  3276,  20475,  98280,  376740,  1184040,  3108105,  6906900,  13123110,  21474180,  30421755,  37442160,  40116600 },
{ 1,  29,  406,  3654,  23751,  118755,  475020,  1560780,  4292145,  10015005,  20030010,  34597290,  51895935,  67863915,  77558760 },
{ 1,  30,  435,  4060,  27405,  142506,  593775,  2035800,  5852925,  14307150,  30045015,  54627300,  86493225,  119759850,  145422675,  155117520 },
{ 1,  31,  465,  4495,  31465,  169911,  736281,  2629575,  7888725,  20160075,  44352165,  84672315,  141120525,  206253075,  265182525,  300540195 },
{ 1,  32,  496,  4960,  35960,  201376,  906192,  3365856,  10518300,  28048800,  64512240,  129024480,  225792840,  347373600,  471435600,  565722720,  601080390 },
{ 1,  33,  528,  5456,  40920,  237336,  1107568,  4272048,  13884156,  38567100,  92561040,  193536720,  354817320,  573166440,  818809200,  1037158320,  1166803110 },
{ 1,  34,  561,  5984,  46376,  278256,  1344904,  5379616,  18156204,  52451256,  131128140,  286097760,  548354040,  927983760,  1391975640,  1855967520,  2203961430,  2333606220 },
{ 1,  35,  595,  6545,  52360,  324632,  1623160,  6724520,  23535820,  70607460,  183579396,  417225900,  834451800,  1476337800,  2319959400,  3247943160,  4059928950,  4537567650 },
{ 1,  36,  630,  7140,  58905,  376992,  1947792,  8347680,  30260340,  94143280,  254186856,  600805296,  1251677700,  2310789600,  3796297200,  5567902560,  7307872110,  8597496600,  9075135300 },
{ 1,  37,  666,  7770,  66045,  435897,  2324784,  10295472,  38608020,  124403620,  348330136,  854992152,  1852482996,  3562467300,  6107086800,  9364199760,  12875774670,  15905368710,  17672631900 },
{ 1,  38,  703,  8436,  73815,  501942,  2760681,  12620256,  48903492,  163011640,  472733756,  1203322288,  2707475148,  5414950296,  9669554100,  15471286560,  22239974430,  28781143380,  33578000610,  35345263800 },
{ 1,  39,  741,  9139,  82251,  575757,  3262623,  15380937,  61523748,  211915132,  635745396,  1676056044,  3910797436,  8122425444,  15084504396,  25140840660,  37711260990,  51021117810,  62359143990,  68923264410 },
{ 1,  40,  780,  9880,  91390,  658008,  3838380,  18643560,  76904685,  273438880,  847660528,  2311801440,  5586853480,  12033222880,  23206929840,  40225345056,  62852101650,  88732378800,  113380261800,  131282408400,  137846528820 },
{ 1,  41,  820,  10660,  101270,  749398,  4496388,  22481940,  95548245,  350343565,  1121099408,  3159461968,  7898654920,  17620076360,  35240152720,  63432274896,  103077446706,  151584480450,  202112640600,  244662670200,  269128937220 },
{ 1,  42,  861,  11480,  111930,  850668,  5245786,  26978328,  118030185,  445891810,  1471442973,  4280561376,  11058116888,  25518731280,  52860229080,  98672427616,  166509721602,  254661927156,  353697121050,  446775310800,  513791607420,  538257874440 },
{ 1,  43,  903,  12341,  123410,  962598,  6096454,  32224114,  145008513,  563921995,  1917334783,  5752004349,  15338678264,  36576848168,  78378960360,  151532656696,  265182149218,  421171648758,  608359048206,  800472431850,  960566918220,  1052049481860 },
{ 1,  44,  946,  13244,  135751,  1086008,  7059052,  38320568,  177232627,  708930508,  2481256778,  7669339132,  21090682613,  51915526432,  114955808528,  229911617056,  416714805914,  686353797976,  1029530696964,  1408831480056,  1761039350070,  2012616400080,  2104098963720 },
{ 1,  45,  990,  14190,  148995,  1221759,  8145060,  45379620,  215553195,  886163135,  3190187286,  10150595910,  28760021745,  73006209045,  166871334960,  344867425584,  646626422970,  1103068603890,  1715884494940,  2438362177020,  3169870830126,  3773655750150,  4116715363800 },
{ 1,  46,  1035,  15180,  163185,  1370754,  9366819,  53524680,  260932815,  1101716330,  4076350421,  13340783196,  38910617655,  101766230790,  239877544005,  511738760544,  991493848554,  1749695026860,  2818953098830,  4154246671960,  5608233007146,  6943526580276,  7890371113950,  8233430727600 },
{ 1,  47,  1081,  16215,  178365,  1533939,  10737573,  62891499,  314457495,  1362649145,  5178066751,  17417133617,  52251400851,  140676848445,  341643774795,  751616304549,  1503232609098,  2741188875414,  4568648125690,  6973199770790,  9762479679106,  12551759587422,  14833897694226,  16123801841550 },
{ 1,  48,  1128,  17296,  194580,  1712304,  12271512,  73629072,  377348994,  1677106640,  6540715896,  22595200368,  69668534468,  192928249296,  482320623240,  1093260079344,  2254848913647,  4244421484512,  7309837001104,  11541847896480,  16735679449896,  22314239266528,  27385657281648,  30957699535776,  32247603683100 },
{ 1,  49,  1176,  18424,  211876,  1906884,  13983816,  85900584,  450978066,  2054455634,  8217822536,  29135916264,  92263734836,  262596783764,  675248872536,  1575580702584,  3348108992991,  6499270398159,  11554258485616,  18851684897584,  28277527346376,  39049918716424,  49699896548176,  58343356817424,  63205303218876 }};
	vector<lluint> Sequence::factorial {1, 1, 2, 6, 24, 120, 720, 5040, 40320, 362880, 3628800, 39916800, 479001600, 6227020800, 87178291200, 1307674368000, 20922789888000, 355687428096000, 6402373705728000, 121645100408832000};
	
	vector<lluint> Sequence::catalan {1, 1, 2, 5, 14, 42, 132, 429, 1430, 4862, 16796, 58786, 208012, 742900, 2674440, 9694845, 35357670, 129644790, 477638700, 1767263190, 6564120420, 24466267020, 91482563640, 343059613650, 1289904147324, 4861946401452, 18367353072152, 69533550916004, 263747951750360, 1002242216651368, 3814986502092304, 14544636039226909, 55534064877048198, 212336130412243110, 812944042149730764, 3116285494907301262};

	vector<lluint> Sequence::motzkin {1, 1, 2, 4, 9, 21, 51, 127, 323, 835, 2188, 5798, 15511, 41835, 113634, 310572, 853467, 2356779, 6536382, 18199284, 50852019, 142547559, 400763223, 1129760415, 3192727797, 9043402501, 25669818476, 73007772802, 208023278209, 593742784829, 1697385471211, 4859761676391, 13933569346707, 40002464776083, 114988706524270, 330931069469828, 953467954114363, 2750016719520991, 7939655757745265, 22944749046030949, 66368199913921497, 192137918101841817, 556704809728838604, 1614282136160911722, 4684478925507420069};

	vector<lluint> Sequence::partitionNumbers {1, 1, 2, 3, 5, 7, 11, 15, 22, 30, 42, 56, 77, 101, 135, 176, 231, 
		297, 385, 490, 627, 792, 1002, 1255, 1575, 1958, 2436, 3010, 3718, 4565, 5604, 6842, 8349, 
		10143, 12310, 14883, 17977, 21637, 26015, 31185, 37338, 44583, 53174, 63261, 75175, 89134, 105558, 
		124754, 147273, 173525, 204226, 239943, 281589, 329931, 386155, 451276, 526823, 614154, 715220, 
		831820, 966467, 1121505, 1300156, 1505499, 1741630, 2012558, 
		2323520, 2679689, 3087735, 3554345, 4087968, 4697205, 5392783, 6185689, 7089500, 8118264, 9289091, 
		10619863, 12132164, 13848650, 15796476, 18004327, 20506255, 23338469, 26543660, 30167357, 34262962, 
		38887673, 44108109, 49995925, 56634173, 64112359, 72533807, 82010177, 92669720, 104651419, 118114304, 
		133230930, 150198136, 169229875, 190569292, 214481126, 241265379, 271248950, 304801365, 342325709, 
		384276336, 431149389, 483502844, 541946240, 607163746, 679903203, 761002156, 851376628, 952050665, 
		1064144451, 1188908248, 1327710076, 1482074143, 1653668665, 1844349560, 2056148051, 2291320912, 2552338241, 
		2841940500, 3163127352, 3519222692, 3913864295, 4351078600, 4835271870, 5371315400, 5964539504, 6620830889, 
		7346629512, 8149040695, 9035836076, 10015581680, 11097645016, 12292341831, 13610949895, 15065878135, 16670689208, 
		18440293320, 20390982757, 22540654445, 24908858009, 27517052599, 30388671978, 33549419497, 37027355200, 40853235313, 
		45060624582, 49686288421, 54770336324, 60356673280, 66493182097, 73232243759, 80630964769, 88751778802, 97662728555, 
		107438159466, 118159068427, 129913904637, 142798995930, 156919475295, 172389800255, 189334822579, 207890420102, 
		228204732751, 250438925115, 274768617130, 301384802048, 330495499613, 362326859895, 397125074750, 435157697830, 
		476715857290, 522115831195, 571701605655, 625846753120, 684957390936, 749474411781, 819876908323, 896684817527, 
		980462880430, 1071823774337, 1171432692373, 1280011042268, 1398341745571, 1527273599625, 1667727404093, 1820701100652, 
		1987276856363, 2168627105469, 2366022741845, 2580840212973, 2814570987591, 3068829878530, 3345365983698, 3646072432125, 
		3972999029388, 4328363658647, 4714566886083, 5134205287973, 5590088317495, 6085253859260, 6622987708040, 7206841706490, 
		7840656226137, 8528581302375, 9275102575355, 10085065885767, 10963707205259, 11916681236278, 12950095925895, 14070545699287, 
		15285151248481, 16601598107914, 18028182516671, 19573856161145, 21248279009367, 23061871173849, 25025873760111, 
		27152408925615, 29454549941750, 31946390696157, 34643126322519, 37561133582570, 40718063627362, 44132934884255, 
		47826239745920,	51820051838712, 56138148670947, 60806135438329, 65851585970275, 71304185514919, 77195892663512, 
		83561103925871, 90436839668817, 97862933703585, 105882246722733, 114540884553038, 123888443077259, 
		133978259344888, 144867692496445, 156618412527946, 169296722391554, 182973889854026, 197726516681672, 
		213636919820625, 230793554364681, 249291451168559, 269232701252579, 290726957916112, 313891991306665, 
		338854264248680, 365749566870782, 394723676655357, 425933084409356, 459545750448675, 495741934760846, 
		534715062908609, 576672674947168, 621837416509615, 670448123060170, 722760953690372, 779050629562167, 
		839611730366814, 904760108316360, 974834369944625, 1050197489931117, 1131238503938606, 1218374349844333, 
		1312051800816215, 1412749565173450, 1520980492851175, 1637293969337171, 1762278433057269, 1896564103591584, 
		2040825852575075, 2195786311682516, 2362219145337711, 2540952590045698, 2732873183547535, 2938929793929555, 
		3160137867148997, 3397584011986773, 3652430836071053, 3925922161489422, 4219388528587095, 4534253126900886, 
		4872038056472084, 5234371069753672, 5622992691950605, 6039763882095515, 6486674127079088, 6965850144195831, 
		7479565078510584, 8030248384943040, 8620496275465025, 9253082936723602, 9930972392403501, 10657331232548839, 
		11435542077822104, 12269218019229465, 13162217895057704, 14118662665280005, 15142952738857194, 
		16239786535829663, 17414180133147295, 18671488299600364, 20017426762576945, 21458096037352891, 
		23000006655487337, 24650106150830490, 26415807633566326, 28305020340996003, 30326181989842964, 
		32488293351466654, 34800954869440830, 37274405776748077, 39919565526999991, 42748078035954696, 
		45772358543578028, 49005643635237875, 52462044228828641, 		56156602112874289, 
		60105349839666544, 64325374609114550, 68834885946073850, 73653287861850339, 78801255302666615, 
		84300815636225119, 90175434980549623, 96450110192202760, 103151466321735325, 110307860425292772, 
		117949491546113972, 126108517833796355, 134819180623301520, 144117936527873832, 154043597379576030, 
		164637479165761044, 175943559810422753, 188008647052292980, 200882556287683159, 214618299743286299, 
		229272286871217150, 244904537455382406, 261578907351144125, 279363328483702152, 298330063062758076, 
		318555973788329084, 340122810048577428, 363117512048110005, 387632532919029223, 413766180933342362, 
		441622981929358437, 471314064268398780, 502957566506000020, 536679070310691121, 572612058898037559, 
		610898403751884101, 651688879997206959, 695143713458946040, 741433159884081684, 790738119649411319, 
		843250788562528427, 899175348396088349, 958728697912338045, 1022141228367345362, 1089657644424399782, 
		1161537834849962850, 1238057794119125085, 1319510599727473500, 1406207446561484054, 1498478743590581081, 
		1596675274490756791, 1701169427975813525, 1812356499739472950, 1930656072350465812, 2056513475336633805, 
		2190401332423765131, 2332821198543892336, 2484305294265418180, 2645418340688763701, 2816759503217942792, 
		2998964447736452194, 3192707518433532826, 3398704041358160275, 3617712763867604423, 3850538434667429186, 
		4098034535626594791, 4361106170762284114, 4640713124699623515, 4937873096788191655, 5253665124416975163, 
		5589233202595404488, 5945790114707874597, 6324621482504294325, 6727090051741041926, 7154640222653942321, 
		7608802843339879269, 8091200276484465581, 8603551759348655060, 9147679068859117602};
	
	lluint factorial(suint n)
	{
		assert(n < Sequence::factorial.size());
		return Sequence::factorial[n];
	}

	lluint binomial(lluint n, lluint r)
	{
		
		if (r > n)
			return 0;
		if (r > n-r)
			r = n-r;
		
		if (n < Sequence::binomial.size())
		{
			return Sequence::binomial[n][r];
		}

		switch (r)
		{
			case (0):
				return 1;
			case (1):
				return n;
			case (2):
				return n*(n-1)/2;
			case (3):
				return n*(n-1)*(n-2)/6;
			default:
				return binomial(n-1,r-1) + binomial(n-1,r);
		}
		
		assert(!"Error!! should not reach here!");
		return 0;
	}
	
	lluint catalan(suint n)
	{
		assert(n < Sequence::catalan.size());
		return Sequence::catalan[n];
	}
	
	lluint motzkin(suint n)
	{
		assert(n < Sequence::motzkin.size());
		return Sequence::motzkin[n];
	}
	
	lluint partition_number(suint n)
	{
		assert (n < Sequence::partitionNumbers.size());
		return Sequence::partitionNumbers[n];
	}

}
